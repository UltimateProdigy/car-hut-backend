generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

enum Role {
  USER
  ADMIN
}

enum FuelType {
  GASOLINE
  DIESEL
  ELECTRIC
  HYBRID
  PLUGIN_HYBRID
}

enum Transmission {
  MANUAL
  AUTOMATIC
}

enum BodyType {
  SEDAN
  COUPE
  HATCHBACK
  SUV
  TRUCK
  VAN
  MINIVAN
  WAGON
}

enum CarStatus {
  AVAILABLE
  PENDING
  SOLD
  DRAFT
}

model User {
  id              String     @id @default(cuid())
  username        String
  password        String
  profile_picture String?
  role            Role       @default(USER)
  created_at      DateTime   @default(now())
  cars            Car[]
  favorites       Favorite[]
  
  @@map("users")
}

model Staff {
  id              String   @id @default(cuid())
  username        String
  password        String
  profile_picture String?
  role            Role     @default(ADMIN)
  created_at      DateTime @default(now())
  
  @@map("staffs")
}

model Brand {
  id    String @id @default(uuid())
  name  String @unique
  logo  String?
  cars  Car[]

  @@map("brands")
}

model Category {
  id    String @id @default(uuid())
  name  String @unique
  cars  Car[]

  @@map("categories")
}

model Car {
  id           String        @id @default(uuid())
  name         String
  description  String?
  model        String
  year         Int
  price        Float
  mileage      Int
  image_url    String?
  images       String[]
  created_at   DateTime      @default(now())
  location     String?
  fuel_type    FuelType?
  transmission Transmission?
  engine_size  String?
  horsepower   Int?
  color        String?
  body_type    BodyType?
  is_active    Boolean       @default(true)
  is_featured  Boolean       @default(false)
  status       CarStatus     @default(AVAILABLE)

  brandId      String
  brand        Brand         @relation(fields: [brandId], references: [id], onDelete: Cascade)

  categoryId   String?
  category     Category?     @relation(fields: [categoryId], references: [id], onDelete: SetNull)

  userId       String
  user         User          @relation(fields: [userId], references: [id], onDelete: Cascade)

  vin          String?       @unique
  licensePlate String?
  features     Feature[]
  favorites    Favorite[]

  @@map("cars")
}

model Feature {
  id          String @id @default(uuid())
  name        String @unique
  description String?
  cars        Car[]

  @@map("features")
}

model Favorite {
  id     String @id @default(uuid())
  userId String
  carId  String
  user   User   @relation(fields: [userId], references: [id], onDelete: Cascade)
  car    Car    @relation(fields: [carId], references: [id], onDelete: Cascade)

  @@unique([userId, carId])
  @@map("favorites")
}